<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">


    <h:body>
        <ui:composition template="/template/base.xhtml">
            <ui:define name="content">
                <style>
                    .nuevo.fc-event {
                        background-color: orange !important;
                    }
                    .enCurso.fc-event {
                        background-color:  darkgreen !important;
                    }
                    .retrazado.fc-event {
                        background-color: red !important;
                    }
                    .finalizado.fc-event {
                        background-color:  darkslateblue !important;
                    }
                    .anulado.fc-event {
                        background-color: darkslategrey !important;
                    }
                </style>  
                <p:panel >
                    <h:form>
                        <p:growl id="messages" showDetail="true" />

                        <h5 style="margin-top: 0">Bienvenido al sistema de gestión de Hidrosa S.A.</h5>
                        <p:schedule id="schedule" value="#{calendarioTrabajoBean.lazyEventModel}"  
                                    widgetVar="myschedule" 
                                    timeZone="America/Asuncion" locale="es" >

                            <p:ajax event="dateSelect" listener="#{calendarioTrabajoBean.onDateSelect}" update="ordenesTrabajoGr" oncomplete="PF('dlgDetalleOrden').show();" />
                            <p:ajax event="eventSelect" listener="#{calendarioTrabajoBean.onEventSelect}" update="ordenesTrabajoGr" oncomplete="PF('dlgDetalleOrden').show();" />
                            <p:ajax event="eventMove" listener="#{calendarioTrabajoBean.onEventMove}" update="messages" />
                            <p:ajax event="eventResize" listener="#{calendarioTrabajoBean.onEventResize}" update="messages" />

                        </p:schedule>

                        <p:dialog header="OrdenesTrabajo" widgetVar="dlgDetalleOrden"
                                  modal="true" showEffect="fade" hideEffect="fade" resizable="false">

                            <h:panelGroup  id="ordenesTrabajoGr">
                                <p:panelGrid columns="6" columnClasses="column">
                                    <p:outputLabel value="Orden #:" styleClass="titulo" />
                                    <p:outputLabel value="#{calendarioTrabajoBean.ordenTrabajo.ordenNro}" /> 

                                    <p:outputLabel value="Cliente:" styleClass="titulo"/>
                                    <p:outputLabel value="#{calendarioTrabajoBean.ordenTrabajo.cliente.nombre}"  />

                                    <h:outputLabel  value="Prioridad: " styleClass="titulo" />
                                    <h:outputLabel  value="#{calendarioTrabajoBean.ordenTrabajo.prioridad} " />

                                    <p:outputLabel  value="fechaInicio:" styleClass="titulo" />
                                    <p:outputLabel  value="#{calendarioTrabajoBean.ordenTrabajo.fechaInicio}" >
                                        <f:convertDateTime pattern="dd MM yyyy" />
                                    </p:outputLabel>
                                    
                                    <p:outputLabel  value="fechaFin:" styleClass="titulo" />
                                    <p:outputLabel  value="#{calendarioTrabajoBean.ordenTrabajo.fechaFin}" >
                                        <f:convertDateTime pattern="dd MM yyyy" />
                                    </p:outputLabel>
                                    
                                    <h:outputLabel  value="Estado: " styleClass="estado" />
                                    <h:outputLabel  value="#{calendarioTrabajoBean.ordenTrabajo.estado.descripcion} " />
                                    
<!--                                    <p:outputLabel value="Estado" />
                                    <h:panelGroup>
                                        <h:outputText value="Nuevo" rendered="{calendarioTrabajoBean.ordenTrabajo.estado eq 0}" />
                                        <h:outputText value="En curso" rendered="{calendarioTrabajoBean.ordenTrabajo.estado eq 1}" />
                                        <h:outputText value="Finalizado" rendered="{calendarioTrabajoBean.ordenTrabajo.estado eq 2}" />
                                    </h:panelGroup>                             -->
                                </p:panelGrid>               
                                <hr/>
                                <p:dataTable id="dtOrdenesDetalle" value="#{calendarioTrabajoBean.ordenTrabajo.ordenTrabajoDetalleList}" 
                                             var="detalle"
                                             paginator="false"                                                                                  
                                             rowKey="#{detalle}"

                                             selectionMode="single" styleClass="impTable"  widgetVar="dtOrdenesTbl">

                                    <p:column headerText="Servicio" sortBy="#{detalle.servicioId.servicio}" style="width:5%;">
                                        <h:outputText value="#{detalle.servicioId.servicio}" />
                                    </p:column>
                                    <p:column headerText="Paleta" sortBy="#{detalle.paletaId.color}" style="width:5%;">
                                        <h:outputText value="#{detalle.paletaId.color}" />
                                    </p:column>
                                    <p:column headerText="Personal" sortBy="#{detalle.personalId.personal}" style="width:5%;">
                                        <h:outputText value="#{detalle.personalId.personal}" />
                                    </p:column>
                                    <p:column headerText="Cantidad" sortBy="#{detalle.cantidad}" style="width:5%;">
                                        <h:outputText value="#{detalle.cantidad}" />
                                    </p:column>
                                    <p:column headerText="Medidas" sortBy="#{detalle.medidas}" style="width:5%;">
                                        <h:outputText value="#{detalle.medidas}" />
                                    </p:column>
                                    <p:column headerText="Consumo" sortBy="#{detalle.consumo}" style="width:5%;">
                                        <h:outputText value="#{detalle.consumo}" />
                                    </p:column>
                                    <p:column headerText="Cabina" sortBy="#{detalle.cabina}" style="width:5%;">
                                        <h:outputText value="#{detalle.cabina}" />
                                    </p:column>
                                    <p:column headerText="Granallado" sortBy="#{detalle.granallado}" style="width:5%;">
                                        <h:outputText value="Si" rendered="#{detalle.granallado}" />
                                    <h:outputText value="No" rendered="#{detalle.granallado ne true}" />
                                    </p:column>
                                    <p:column headerText="Total" sortBy="#{detalle.total}" style="width:5%;">
                                        <h:outputText value="#{detalle.total}" >
                                            <f:convertNumber pattern="###,###"  currencyCode="PYG"/>
                                        </h:outputText>
                                    </p:column>  
                                </p:dataTable>
                            </h:panelGroup>
                        </p:dialog>
                        <p:dialog widgetVar="eventDialog" header="Detalle de la orden" showEffect="clip" hideEffect="clip">
                            <h:panelGrid id="eventDetails" columns="2">

                                <p:outputLabel for="title" value="Cliente:" />
                                <p:outputLabel id="title" value="#{calendarioTrabajoBean.event.title}"  />

                                <p:outputLabel for="from" value="inicio:" />
                                <p:calendar id="from" value="#{calendarioTrabajoBean.event.startDate}" timeZone="GMT+2" pattern="dd/MM/yyyy HH:mm"/>

                                <p:outputLabel for="to" value="fin:" />
                                <p:calendar id="to" value="#{calendarioTrabajoBean.event.endDate}" timeZone="GMT+2" pattern="dd/MM/yyyy HH:mm"/>

                                <p:outputLabel for="allDay" value="All Day:" />
                                <h:selectBooleanCheckbox id="allDay" value="#{calendarioTrabajoBean.event.allDay}" />

                                <p:commandButton type="reset" value="Reset" />
                                <p:commandButton id="addButton" value="Save" actionListener="#{calendarioTrabajoBean.addEvent}" oncomplete="PF('myschedule').update();PF('eventDialog').hide();" />

                            </h:panelGrid>
                        </p:dialog>    
                    </h:form>

                    <script type="text/javascript">
                        PrimeFaces.locales["es"] = {
                            closeText: "Cerrar",
                            prevText: "Anterior",
                            nextText: "Siguiente",
                            monthNames: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                            monthNamesShort: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                            dayNames: ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"],
                            dayNamesShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
                            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
                            weekHeader: "Semana",
                            firstDay: 0,
                            isRTL: false,
                            showMonthAfterYear: false,
                            yearSuffix: "",
                            timeOnlyTitle: "Solo hora",
                            timeText: "Tiempo",
                            hourText: "Hora",
                            minuteText: "Minuto",
                            secondText: "Segundo",
                            currentText: "Fecha actual",
                            ampm: false,
                            month: "Mes",
                            week: "Semana",
                            day: "Día",
                            allDayText: "Todo el día"
                        };
                    </script>
                </p:panel>
            </ui:define>
        </ui:composition>
    </h:body>
</html>